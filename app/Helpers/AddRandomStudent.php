<?php
namespace Students\Helpers;

class AddRandomStudent {
    private $db;

    private $firstname;
    private $lastname;
    private $gender;
    private $groupNum;
    private $points;
    private $year;
    private $email;
    private $residence;
    private $hash;

    public function __construct($db) {
        $this->db = $db;
    }

    public function AddRandomStudent($number = 500) {
        $templateFirstname = array(
            ['Авдей', 'Аверкий', 'Авксентий', 'Агафон', 'Александр', 'Алексей', 'Альберт', 'Альвиан', 'Анатолий', 'Андрей', 'Антон', 'Антонин', 'Анфим', 'Аристарх', 'Аркадий', 'Арсений', 'Артём', 'Артур', 'Архипп', 'Афанасий', 'Богдан', 'Борис', 'Вадим', 'Валентин', 'Валерий', 'Валерьян', 'Варлам', 'Варфоломей', 'Василий', 'Венедикт', 'Вениамин', 'Викентий', 'Виктор', 'Виссарион', 'Виталий', 'Владимир', 'Владислав', 'Владлен', 'Влас', 'Всеволод', 'Вячеслав', 'Гавриил', 'Галактион', 'Геласий', 'Геннадий', 'Георгий', 'Герасим', 'Герман', 'Глеб', 'Гордей', 'Григорий', 'Даниил', 'Демид', 'Демьян', 'Денис', 'Дмитрий', 'Добрыня', 'Донат', 'Дорофей', 'Евгений', 'Евграф', 'Евдоким', 'Евсей', 'Евстафий', 'Егор', 'Емельян', 'Еремей', 'Ермолай', 'Ефим', 'Ждан', 'Зиновий', 'Иакинф', 'Иван', 'Игнатий', 'Игорь', 'Иларион', 'Илья', 'Иннокентий', 'Ираклий', 'Ириней', 'Исидор', 'Иулиан', 'Касьян', 'Ким', 'Кирилл', 'Климент', 'Кондрат', 'Константин', 'Корнилий', 'Кузьма', 'Куприян', 'Лаврентий', 'Леонид', 'Леонтий', 'Лука', 'Лукий', 'Лукьян', 'Магистриан', 'Макар', 'Максим', 'Марк', 'Мартын', 'Матвей', 'Мелентий', 'Мирон', 'Мирослав', 'Митрофан', 'Михаил', 'Мстислав', 'Мэлор', 'Назар', 'Нестор', 'Никанор', 'Никита', 'Никифор', 'Николай', 'Никон', 'Олег', 'Онисим', 'Павел', 'Пантелеймон', 'Парфений', 'Пётр', 'Порфирий', 'Потап', 'Прокопий', 'Протасий', 'Прохор', 'Разумник', 'Родион', 'Роман', 'Ростислав', 'Руслан', 'Савва', 'Савелий', 'Самуил', 'Святополк', 'Святослав', 'Севастьян', 'Семён', 'Сергей', 'Сильвестр', 'Созон', 'Спиридон', 'Станислав', 'Степан', 'Тарас', 'Тимофей', 'Тимур', 'Тихон', 'Трифон', 'Трофим', 'Фаддей', 'Фёдор', 'Федосей', 'Федот', 'Феликс', 'Феоктист', 'Филат', 'Филипп', 'Фома', 'Фрол', 'Харитон', 'Христофор', 'Эдуард', 'Эраст', 'Юлиан', 'Юрий', 'Юстин', 'Яков', 'Якун', 'Ярослав'],
            ['Агафья', 'Агриппина', 'Акулина', 'Алевтина', 'Александра', 'Алина', 'Алла', 'Анастасия', 'Ангелина', 'Анжела', 'Анжелика', 'Анна', 'Антонина', 'Валентина', 'Валерия', 'Варвара', 'Василиса', 'Вера', 'Вероника', 'Виктория', 'Галина', 'Глафира', 'Дана', 'Дарья', 'Евгения', 'Евдокия', 'Евпраксия', 'Евфросиния', 'Екатерина', 'Елена', 'Елизавета', 'Ермиония', 'Жанна', 'Зинаида', 'Злата', 'Зоя', 'Инга', 'Инесса', 'Иоанна', 'Ираида', 'Ирина', 'Ия', 'Карина', 'Каролина', 'Кира', 'Клавдия', 'Ксения', 'Лада', 'Лариса', 'Лидия', 'Лилия', 'Любовь', 'Людмила', 'Маргарита', 'Марина', 'Мария', 'Марфа', 'Матрёна', 'Мирослава', 'Надежда', 'Наина', 'Наталья', 'Нина', 'Нонна', 'Оксана', 'Октябрина', 'Ольга', 'Пелагея', 'Полина', 'Прасковья', 'Раиса', 'Регина', 'Светлана', 'Серафима', 'Снежана', 'София', 'Таисия', 'Тамара', 'Татьяна', 'Ульяна', 'Фаина', 'Феврония', 'Фёкла', 'Феодора', 'Целестина', 'Юлия', 'Яна', 'Ярослава']);
        $templateLastname = array('Смирнов', 'Иванов', 'Кузнецов', 'Соколов', 'Попов', 'Лебедев', 'Козлов', 'Новиков', 'Морозов', 'Петров', 'Волков', 'Соловьёв', 'Васильев', 'Зайцев', 'Павлов', 'Семёнов', 'Голубев', 'Виноградов', 'Богданов', 'Воробьёв', 'Фёдоров', 'Михайлов', 'Беляев', 'Тарасов', 'Белов', 'Комаров', 'Орлов', 'Киселёв', 'Макаров', 'Андреев', 'Ковалёв', 'Ильин', 'Гусев', 'Титов', 'Кузьмин', 'Кудрявцев', 'Баранов', 'Куликов', 'Алексеев', 'Степанов', 'Яковлев', 'Сорокин', 'Сергеев', 'Романов', 'Захаров', 'Борисов', 'Королёв', 'Герасимов', 'Пономарёв', 'Григорьев', 'Лазарев', 'Медведев', 'Ершов', 'Никитин', 'Соболев', 'Рябов', 'Поляков', 'Цветков', 'Данилов', 'Жуков', 'Фролов', 'Журавлёв', 'Николаев', 'Крылов', 'Максимов', 'Сидоров', 'Осипов', 'Белоусов', 'Федотов', 'Дорофеев', 'Егоров', 'Матвеев', 'Бобров', 'Дмитриев', 'Калинин', 'Анисимов', 'Петухов', 'Антонов', 'Тимофеев', 'Никифоров', 'Веселов', 'Филиппов', 'Марков', 'Большаков', 'Суханов', 'Миронов', 'Ширяев', 'Александров', 'Коновалов', 'Шестаков', 'Казаков', 'Ефимов', 'Денисов', 'Громов', 'Фомин', 'Давыдов', 'Мельников', 'Щербаков', 'Блинов', 'Колесников', 'Карпов', 'Афанасьев', 'Власов', 'Маслов', 'Исаков', 'Тихонов', 'Аксёнов', 'Гаврилов', 'Родионов', 'Котов', 'Горбунов', 'Кудряшов', 'Быков', 'Зуев', 'Третьяков', 'Савельев', 'Панов', 'Рыбаков', 'Суворов', 'Абрамов', 'Воронов', 'Мухин', 'Архипов', 'Трофимов', 'Мартынов', 'Емельянов', 'Горшков', 'Чернов', 'Овчинников', 'Селезнёв', 'Панфилов', 'Копылов', 'Михеев', 'Галкин', 'Назаров', 'Лобанов', 'Лукин', 'Беляков', 'Потапов', 'Некрасов', 'Хохлов', 'Жданов', 'Наумов', 'Шилов', 'Воронцов', 'Ермаков', 'Дроздов', 'Игнатьев', 'Савин', 'Логинов', 'Сафонов', 'Капустин', 'Кириллов', 'Моисеев', 'Елисеев', 'Кошелев', 'Костин', 'Горбачёв', 'Орехов', 'Ефремов', 'Исаев', 'Евдокимов', 'Калашников', 'Кабанов', 'Носков', 'Юдин', 'Кулагин', 'Лапин', 'Прохоров', 'Нестеров', 'Харитонов', 'Агафонов', 'Муравьёв', 'Ларионов', 'Федосеев', 'Зимин', 'Пахомов', 'Шубин', 'Игнатов', 'Филатов', 'Крюков', 'Рогов', 'Кулаков', 'Терентьев', 'Молчанов', 'Владимиров', 'Артемьев', 'Гурьев', 'Зиновьев', 'Гришин', 'Кононов', 'Дементьев', 'Ситников', 'Симонов', 'Мишин', 'Фадеев', 'Комиссаров', 'Мамонтов', 'Носов', 'Гуляев', 'Шаров', 'Устинов', 'Вишняков', 'Евсеев', 'Лаврентьев', 'Брагин', 'Константинов', 'Корнилов', 'Авдеев', 'Зыков', 'Бирюков', 'Шарапов', 'Никонов', 'Щукин', 'Дьячков', 'Одинцов', 'Сазонов', 'Якушев', 'Красильников', 'Гордеев', 'Самойлов', 'Князев', 'Беспалов', 'Уваров', 'Шашков', 'Бобылёв', 'Доронин', 'Белозёров', 'Рожков', 'Самсонов', 'Мясников', 'Лихачёв', 'Буров', 'Сысоев', 'Фомичёв', 'Русаков', 'Стрелков', 'Гущин', 'Тетерин', 'Колобов', 'Субботин', 'Фокин', 'Блохин', 'Селиверстов', 'Пестов', 'Кондратьев', 'Силин', 'Меркушев', 'Лыткин', 'Туров');
        $templateGender = array('male', 'female');
        $templateGroupNum = array('MG-13', 'FT-22', 'BN-54', 'KO-65', 'RT-38', 'MQ-63', 'FT-72', 'UN-44', 'KO-26', 'VT-18');
        $templatePoints = array(0, 500);
        $templateEmail = array('@gmail.com', '@outlook.com', '@yahoo.com', '@mail.com', '@mail.ru', '@yandex.ru');
        $templateYear = array(1985, 1995);
        $templateResidence = array('resident', 'nonresident');
        $replace = array(
            "А"=>"A","а"=>"a",
            "Б"=>"B","б"=>"b",
            "В"=>"V","в"=>"v",
            "Г"=>"G","г"=>"g",
            "Д"=>"D","д"=>"d",
            "Е"=>"Ye","е"=>"e",
            "Ё"=>"Ye","ё"=>"e",
            "Ж"=>"Zh","ж"=>"zh",
            "З"=>"Z","з"=>"z",
            "И"=>"I","и"=>"i",
            "Й"=>"Y","й"=>"y",
            "К"=>"K","к"=>"k",
            "Л"=>"L","л"=>"l",
            "М"=>"M","м"=>"m",
            "Н"=>"N","н"=>"n",
            "О"=>"O","о"=>"o",
            "П"=>"P","п"=>"p",
            "Р"=>"R","р"=>"r",
            "С"=>"S","с"=>"s",
            "Т"=>"T","т"=>"t",
            "У"=>"U","у"=>"u",
            "Ф"=>"F","ф"=>"f",
            "Х"=>"Kh","х"=>"kh",
            "Ц"=>"Ts","ц"=>"ts",
            "Ч"=>"Ch","ч"=>"ch",
            "Ш"=>"Sh","ш"=>"sh",
            "Щ"=>"Shch","щ"=>"shch",
            "Ъ"=>"","ъ"=>"",
            "Ы"=>"Y","ы"=>"y",
            "Ь"=>"","ь"=>"",
            "Э"=>"E","э"=>"e",
            "Ю"=>"Yu","ю"=>"yu",
            "Я"=>"Ya","я"=>"ya",
        );

        for ($i=0; $i < $number; $i++) {
            $isEmailUsed = false;
            $sex = rand(0, 1);
            $this->firstname[] = $templateFirstname[$sex][array_rand($templateFirstname[$sex])];
            $this->lastname[] = $sex == 0 ? $templateLastname[array_rand($templateLastname)] : $templateLastname[array_rand($templateLastname)] . 'а';
            $this->gender[] = $sex == 0 ? $templateGender[0] : $templateGender[1];
            $this->groupNum[] = $templateGroupNum[array_rand($templateGroupNum)];
            $this->points[] = rand($templatePoints[0], $templatePoints[1]);
            $this->year[] = rand($templateYear[0], $templateYear[1]);
            $mail = strtr($this->firstname[$i] . $this->lastname[$i] . $this->year[$i], $replace) . $templateEmail[array_rand($templateEmail)];
            if (in_array($mail, $this->email) == true) {
                $isEmailUsed = true;
            }
            $this->email[] = $mail;
            $this->residence[] = $templateResidence[array_rand($templateResidence)];
            $this->hash[] = Util::randHash(32);

            if ($isEmailUsed === false) {
                $sql = "INSERT INTO `students` (`firstname`, `lastname`, `gender`, `groupNum`, `email`, `points`, `year`, `residence`, `hash`)
                VALUES (:firstname, :lastname, :gender, :groupNum, :email, :points, :year, :residence, :hash)";
                $stmt = $this->db->prepare($sql);
                $stmt->bindValue(':firstname', $this->firstname[$i], \PDO::PARAM_STR);
                $stmt->bindValue(':lastname', $this->lastname[$i], \PDO::PARAM_STR);
                $stmt->bindValue(':gender', $this->gender[$i], \PDO::PARAM_STR);
                $stmt->bindValue(':groupNum', $this->groupNum[$i], \PDO::PARAM_STR);
                $stmt->bindValue(':email', $this->email[$i], \PDO::PARAM_STR);
                $stmt->bindValue(':points', $this->points[$i], \PDO::PARAM_INT);
                $stmt->bindValue(':year', $this->year[$i], \PDO::PARAM_INT);
                $stmt->bindValue(':residence', $this->residence[$i], \PDO::PARAM_STR);
                $stmt->bindValue(':hash', $this->hash[$i], \PDO::PARAM_STR);
                $stmt->execute();
            } else {
                $number++;
            }
        }
    }
}